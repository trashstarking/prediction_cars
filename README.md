# prediction_cars
Стримлит приложение для предсказания цен авто https://predictcarsprice.streamlit.app/

Описание работы

1. EDA
В ходе анализа данных были выполнены следующие шаги:
Найдены и удалены неявные дубликатов.
Использован инструмент `ydata-profiling` для получения общего обзора датасета.
Построены гистограммы распределений, pairplot и Heatmap корреляций для выявления зависимостей и выбросов.

2. Предобработка данных 
Удалены единицы измерения (`kmpl`, `CC`, `bhp`) из признаков `mileage`, `engine`, `max_power`. Данные приведены к числовому формату.
Из признака `torque` (крутящий момент) с помощью регулярных выражений извлечены два новых признака: величина момента (Nm) и обороты двигателя (RPM).
Пропуски заполнены медианными значениями тренировочного датасета.
Для линейных моделей использовано OneHotEncoding.
Для CatBoost использован встроенный механизм обработки категориальных признаков.

3. Feature Engineering
Сгенерированы новые признаки, повысившие качество модели:
`age` - возраст автомобиля (текущий год - год выпуска).
`km_per_year` - интенсивность использования (средний пробег в год).
`power_per_liter` - удельная мощность двигателя.
`brand` - марка автомобиля, выделенная из названия.

4. Моделирование
Были обучены и сравнены несколько моделей: `LinearRegression`, `Lasso`, `Ridge`, `ElasticNet` и `CatBoostRegressor`.

Результаты и Метрики

Ниже представлено сравнение качества моделей на тестовой выборке:

|------Модель------|  R2  Score  | Интерпретация 

| Linear Regression      |     0.59    | Модель слабо улавливает нелинейные зависимости. 

| Lasso / ElasticNet     |     0.59    | L1 регуляризация не дала прироста.

| Ridge Regression       |     0.78    | L2 регуляризация + OHE кодирование значительно улучшили результат. 

| CatBoost (лучши)        |     0.97    | Бустинг отлично сработал с категориальными признаками. 

Бизнес-метрика: Модель CatBoost дает прогноз с отклонением от реальной цены менее 10% примерно в 48.7% случаев.

Анализ эффективности

Что дало наибольший прирост качества?
1.  Смена алгоритма Переход от линейных моделей к градиентному бустингу.
2.  Избавление от мультиколлинеарности

Что сделать не удалось?
1. Не реализован некоторые пункты, не вписался во время
2. Не вывел некоторые сравнения моделей
3. Можно было бы глубже поработать с фичами и дополнительно потюнить гиперпараметры

Оценка сервиса на стримлит

Реализована возможность как загрузки CSV-файла для пакетной обработки, так и ручного ввода параметров через форму.
Использование `st.selectbox` для выбора предотвращает опечатки пользователя.
Интерфейс разделен на логические вкладки, что делает его чистым и понятным.

Визуализация
Гистограмма показывает распределние цен без выбросов.
Boxplot демонстрирует популярность брендов.
График с важностью параметров делает работу модели прозрачной.
